<!-- Profile Posts -->
        <section class="feed">
            <div class="post-box">
                <h2>{{ user_profile.get_full_name|default:user_profile.username }}'s posts</h2>
            </div>

            {% for post in posts %}
            <div class="post" id="post-{{ post.id }}">
                <div style="display:flex;align-items:center;justify-content:space-between;">
                    <h4>{{ post.user.username }}</h4>
                </div>

                {% if post.title %}
                <h3>{{ post.title }}</h3>
                {% endif %}

                <p>{{ post.content }}</p>

                {% if post.url %}
                <p>
                    <a href="{{ post.url }}" target="_blank" rel="noopener noreferrer">
                        {{ post.url }}
                    </a>
                </p>
                {% endif %}

                {% if post.image %}
                <img src="{{ post.image.url }}" width="200">
                {% endif %}

                {% if post.video %}
                <video width="300" controls>
                    <source src="{{ post.video.url }}">
                </video>
                {% endif %}
                <div class="post-btns">
                    <button class="post-like-btn {% if post.id in liked_post_ids %}liked{% endif %}"
                        data-post-id="{{ post.id }}">
                        <i class="fa-regular fa-thumbs-up"></i>
                        <span class="like-text">Like</span>
                        <span class="like-count">{{ post.likes.count }}</span>
                    </button>
                    <button class="comment-toggle"><i class="fa-regular fa-comment-dots"></i> Comment <span
                            class="comment-count">{{ post.comments.count }}</span></button>
                    <button class="share-toggle" data-post-id="{{ post.id }}"><i class="fa-solid fa-paper-plane"></i> Share</button>
                </div>
                <!-- share dropdown removed; modal will be used -->
            </div>
            {% endfor %}

            <!-- Share Modal (reusable) -->
            <div id="shareModal" class="modal" style="display:none;">
                <div class="modal-content">
                    <span class="close" id="shareModalClose">&times;</span>
                    <h3>Share post</h3>
                    <p>Select a connection to share this post with:</p>
                    <ul id="shareModalUserList">
                        {% if connection_users %}
                            {% for u in connection_users %}
                                <li><button class="modal-share-to-user" data-user-id="{{ u.id }}">Share to {{ u.username }}</button></li>
                            {% endfor %}
                        {% else %}
                            <li>No connections to share with</li>
                        {% endif %}
                    </ul>
                </div>
            </div>

        </section>